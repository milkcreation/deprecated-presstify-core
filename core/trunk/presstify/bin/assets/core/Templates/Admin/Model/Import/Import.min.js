jQuery(document).ready(function(t){var e=0,a=!1,o=[],r=[];t(document).on("click",".tiFyTemplatesImport-RowImport",function(r){if(r.preventDefault(),!a){a=!0,o=[],s();var n=t(this).closest("tr");e=1,i(n)}}),t(document).on("click",".tiFyTemplatesImport-submit",function(r){if(r.preventDefault(),!a){a=!0,o=[],s();var n=AjaxListTable.page.info();e=n.recordsDisplay,t("#tiFyTemplatesImport-ProgressBar").tiFyProgress("option",{value:0,max:e,show:!0,info:'<span style="color:#2980b9;">'+tiFyTemplatesAdminImport.prepare+"</span>",close:function(e,o){o.infos('<span style="color:#f1c40f;">'+tiFyTemplatesAdminImport.cancel+"</span>"),a=!1,t(document).on("tiFyTemplatesImport.complete",function(){o.close()})}}),n.page?AjaxListTable.page(0).draw("page"):AjaxListTable.draw(!1),t(document).on("draw.dt.tiFyTemplatesImport",function(e,a,o,r){var s=t(AjaxListTable.row(":eq(0)",{page:"current"}).node());i(s),t(this).unbind("draw.dt.tiFyTemplatesImport")})}});var s=function(){e="";if(t('form[name="tiFyTemplatesImport-optionsForm"]').length){var e=t('form[name="tiFyTemplatesImport-optionsForm"]').serializeArray();r={},t.each(e,function(t,e){r[e.name]=e.value})}},i=function(s){if(e&&a){var n=t(".tiFyTemplatesImport-RowImport",s).data("item_index_key"),p=t(".tiFyTemplatesImport-RowImport",s).data("item_index_value"),m=!!s.is(":last-child"),l={};l[n]=p,(import_data=JSON.parse(decodeURIComponent(t("#ajaxImportData").val())))&&(l=t.extend(l,import_data)),(datatables_data=JSON.parse(decodeURIComponent(t("#ajaxDatatablesData").val())))&&(l=t.extend(l,datatables_data)),r&&(l=t.extend(l,{__import_options:r})),s.addClass("active"),t("td",s).each(function(){t(this).append('<div class="tdOverlay"/>')}),t.ajax({url:tify_ajaxurl,type:"POST",data:l,dataType:"json",success:function(r,n,l){o[p]=r.notices;var d="";if(t.each(r.notices,function(e,a){t.each(a,function(t,a){a.message&&(d+='<span style="color:'+tiFyTemplatesAdminImport.notices[e].color+';display:block;">'+a.message+"</span>")})}),t("#tiFyTemplatesImport-ProgressBar").tiFyProgress("infos",d),t("#tiFyTemplatesImport-ProgressBar").tiFyProgress("increase"),!--e)return AjaxListTable.draw("page"),void t(document).on("draw.dt.tiFyTemplatesImport",function(e,o,r,s){t("#tiFyTemplatesImport-ProgressBar").tiFyProgress("close"),a=!1,i(0),t(this).unbind("draw.dt.tiFyTemplatesImport")});if(m){c=0;AjaxListTable.page("next").draw("page")}else{var c=s.next().index();AjaxListTable.draw("page")}t(document).on("draw.dt.tiFyTemplatesImport",function(e,a,o,r){var s=t(AjaxListTable.row(":eq("+c+")",{page:"current"}).node());i(s),t(this).unbind("draw.dt.tiFyTemplatesImport")})}})}else t(document).trigger("tiFyTemplatesImport.complete")}});